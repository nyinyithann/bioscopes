// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Hero from "./Hero.js";
import * as Curry from "rescript/lib/es6/curry.js";
import * as React from "react";
import * as $$Window from "../../hooks/Window.js";
import * as Loading from "../Loading.js";
import * as VideoPanel from "./VideoPanel.js";
import * as ModalDialog from "../ModalDialog.js";
import * as PhotosPanel from "./PhotosPanel.js";
import * as ErrorDisplay from "../ErrorDisplay.js";
import * as UrlQueryParam from "../../routes/UrlQueryParam.js";
import * as MoviesProvider from "../../providers/MoviesProvider.js";
import * as StorylinePanel from "./StorylinePanel.js";
import * as React$1 from "@headlessui/react";
import Youtube from "react-player/youtube";
import * as YoutubePlayerProvider from "../../providers/YoutubePlayerProvider.js";
import * as Outline from "@heroicons/react/outline";

function string(prim) {
  return prim;
}

function Movie(Props) {
  var match = MoviesProvider.useMoviesContext(undefined);
  var loadDetailMovie = match.loadDetailMovie;
  var error = match.error;
  var detail_movie = match.detail_movie;
  var match$1 = YoutubePlayerProvider.useVideoPlayerContext(undefined);
  var stop = match$1.stop;
  var videoPlayState = match$1.videoPlayState;
  var windowSize = $$Window.useWindowSize(undefined);
  var match$2 = UrlQueryParam.useQueryParams(undefined);
  var queryParam = match$2[0];
  React.useMemo((function () {
          var t = detail_movie.title;
          if (t !== undefined) {
            window.document.title = t;
          } else {
            window.document.title = "Bioscopes";
          }
        }), [detail_movie]);
  React.useEffect((function () {
          var controller = new AbortController();
          if (queryParam.TAG === /* Movie */3) {
            var match = queryParam._0;
            Curry._2(loadDetailMovie, {
                  TAG: /* Movie */3,
                  _0: {
                    id: match.id,
                    media_type: match.media_type
                  }
                }, controller.signal);
          }
          return (function (param) {
                    controller.abort("Cancel the request");
                  });
        }), []);
  if (error.length > 0) {
    return React.createElement(ErrorDisplay.make, {
                errorMessage: error
              });
  } else if (match.loading) {
    return React.createElement(Loading.make, {
                className: "w-[6rem] h-[3rem] stroke-[0.2rem] p-3 stroke-klor-200 text-green-500 fill-50 dark:fill-slate-600 dark:stroke-slate-400 dark:text-900 m-auto"
              });
  } else {
    return React.createElement("main", {
                className: "flex border-t-[2px] border-slate-200"
              }, React.createElement("div", {
                    className: "flex flex-col w-full h-full"
                  }, React.createElement("div", {
                        className: "w-full",
                        id: "hero_container"
                      }, React.createElement(Hero.make, {
                            movie: detail_movie
                          })), React.createElement("div", {
                        className: "w-full flex pt-1",
                        id: "movie_info_tab_container"
                      }, React.createElement(React$1.Tab.Group, {
                            children: (function (selectedIndex) {
                                return React.createElement("div", {
                                            className: "flex flex-col w-full"
                                          }, React.createElement(React$1.Tab.List, {
                                                className: "flex w-full flex-nowrap items-center justify-around",
                                                children: (function (param) {
                                                    return React.createElement(React.Fragment, undefined, React.createElement(React$1.Tab, {
                                                                    className: "control-color flex flex-col items-center justify-center w-full h-full outline-none ring-0 border-r-[1px] border-300",
                                                                    children: (function (props) {
                                                                        return React.createElement("div", {
                                                                                    className: "" + (
                                                                                      props.selected ? "bg-300 text-900" : ""
                                                                                    ) + " w-full h-full control-color flex items-center justify-center py-2"
                                                                                  }, "OVERVIEW");
                                                                      }),
                                                                    key: "overview"
                                                                  }), React.createElement(React$1.Tab, {
                                                                    className: "control-color flex flex-col items-center justify-center w-full h-full outline-none ring-0 border-r-[1px] border-300",
                                                                    children: (function (props) {
                                                                        return React.createElement("div", {
                                                                                    className: "" + (
                                                                                      props.selected ? "bg-300 text-900" : ""
                                                                                    ) + " w-full h-full control-color flex items-center justify-center py-2"
                                                                                  }, "VIDEOS");
                                                                      }),
                                                                    key: "videos"
                                                                  }), React.createElement(React$1.Tab, {
                                                                    className: "control-color flex flex-col items-center justify-center w-full h-full outline-none ring-0 border-r-[1px] border-300",
                                                                    children: (function (props) {
                                                                        return React.createElement("div", {
                                                                                    className: "" + (
                                                                                      props.selected ? "bg-300 text-900" : ""
                                                                                    ) + " w-full h-full control-color flex items-center justify-center py-2"
                                                                                  }, "PHOTOS");
                                                                      }),
                                                                    key: "photos"
                                                                  }));
                                                  })
                                              }), React.createElement(React$1.Tab.Panels, {
                                                className: "pt-1",
                                                children: (function (props) {
                                                    return React.createElement(React.Fragment, undefined, React.createElement(React$1.Tab.Panel, {
                                                                    children: (function (props) {
                                                                        return React.createElement("div", {
                                                                                    className: "flex w-full p-2"
                                                                                  }, React.createElement(StorylinePanel.make, {
                                                                                        movie: detail_movie
                                                                                      }));
                                                                      }),
                                                                    key: "overview-panel"
                                                                  }), React.createElement(React$1.Tab.Panel, {
                                                                    children: (function (props) {
                                                                        return React.createElement("div", {
                                                                                    className: "flex w-full p-2"
                                                                                  }, React.createElement(VideoPanel.make, {
                                                                                        movie: detail_movie
                                                                                      }));
                                                                      }),
                                                                    key: "videos-panel"
                                                                  }), React.createElement(React$1.Tab.Panel, {
                                                                    children: (function (props) {
                                                                        return React.createElement("div", {
                                                                                    className: "flex w-full p-2"
                                                                                  }, React.createElement(PhotosPanel.make, {
                                                                                        movie: detail_movie
                                                                                      }));
                                                                      }),
                                                                    key: "photos-panel"
                                                                  }));
                                                  })
                                              }));
                              })
                          }))), React.createElement(ModalDialog.make, {
                    isOpen: videoPlayState.playing,
                    onClose: (function (param) {
                        Curry._1(stop, undefined);
                      }),
                    className: "relative z-50",
                    panelClassName: "w-full h-full transform overflow-hidden transition-all",
                    children: null
                  }, React.createElement("div", {
                        onClick: (function (param) {
                            Curry._1(stop, undefined);
                          })
                      }, React.createElement(Outline.XIcon, {
                            className: "absolute z-50 top-0 right-4 w-12 h-12 p-2 border-2 border-slate-400 fill-white stroke-white hover:bg-slate-500 rounded-full bg-slate-900"
                          })), React.createElement(Youtube, {
                        url: videoPlayState.url,
                        playing: videoPlayState.playing,
                        controls: true,
                        width: "" + (windowSize.width - 32 | 0).toString() + "px",
                        height: "" + (windowSize.height - 32 | 0).toString() + "px"
                      })));
  }
}

var make = Movie;

export {
  string ,
  make ,
}
/* Hero Not a pure module */
